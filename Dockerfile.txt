# 使用官方轻量级镜像
FROM node:18-alpine

# 设置工作目录
WORKDIR /app

# 复制依赖文件并安装
COPY package*.json ./
RUN npm install --production

# 复制源代码
COPY . .

# Cloud Run 默认注入 PORT 环境变量，必须监听这个端口
ENV PORT=8080
EXPOSE 8080

# 启动命令
CMD [ "npm", "start" ]